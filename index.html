<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Traffic Master Ultimate - Monthachai Driving School</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        /* --- THEME VARIABLES --- */
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #eff6ff;
            --bg-main: #f3f4f6;
            --bg-card: #ffffff;
            --text-main: #1f2937;
            --text-muted: #6b7280;
            --border-color: #e5e7eb;
            --sidebar-bg: #ffffff;
            --accent: #f59e0b;
            --danger: #dc2626;
            --success: #10b981;
            --shadow: rgba(0,0,0,0.05);
            --sidebar-width: 280px;
        }

        body.dark-mode {
            --primary: #3b82f6;
            --secondary: #1e293b;
            --bg-main: #0f172a;
            --bg-card: #1e293b;
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --border-color: #334155;
            --sidebar-bg: #111827;
            --shadow: rgba(0,0,0,0.3);
        }

        body {
            font-family: 'Sarabun', sans-serif;
            margin: 0; display: flex; height: 100vh; overflow: hidden;
            background: var(--bg-main); color: var(--text-main);
            line-height: 1.6; position: relative; transition: background 0.3s, color 0.3s;
        }

        /* --- ANIMATIONS --- */
        .bg-animation {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; pointer-events: none; overflow: hidden; opacity: 0.6;
        }
        .floating-item {
            position: absolute; bottom: -100px; opacity: 0;
            animation: floatUp linear infinite; filter: blur(2px); font-size: 3rem;
        }
        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            20% { opacity: 0.2; } 80% { opacity: 0.2; }
            100% { transform: translateY(-120vh) rotate(360deg); opacity: 0; }
        }
        .item-1 { left: 10%; animation-duration: 15s; } 
        .item-2 { left: 30%; animation-duration: 25s; animation-delay: 5s; font-size: 2rem; }
        .item-3 { left: 50%; animation-duration: 18s; animation-delay: 2s; font-size: 5rem; } 
        .item-4 { left: 70%; animation-duration: 22s; animation-delay: 8s; }

        /* --- UI COMPONENTS --- */
        #welcome-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 9999; color: white; text-align: center; transition: opacity 0.5s ease;
        }
        .welcome-box {
            background: rgba(255,255,255,0.05); padding: 50px 70px; border-radius: 30px;
            border: 1px solid rgba(255,255,255,0.1); box-shadow: 0 0 50px rgba(37, 99, 235, 0.3);
            animation: popup 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        @keyframes popup { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        
        .welcome-btn {
            margin-top: 30px; padding: 15px 50px; font-size: 1.3rem;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            color: white; border: none; border-radius: 50px; cursor: pointer;
            font-weight: 800; letter-spacing: 1px; box-shadow: 0 10px 30px rgba(37, 99, 235, 0.4);
            transition: all 0.3s;
        }
        .welcome-btn:hover { transform: translateY(-3px) scale(1.05); }

        /* --- SIDEBAR & PROFILE --- */
        .sidebar {
            width: var(--sidebar-width); background: var(--sidebar-bg); border-right: 1px solid var(--border-color);
            display: flex; flex-direction: column; padding: 25px; flex-shrink: 0;
            position: relative; z-index: 10; box-shadow: 5px 0 20px var(--shadow);
            transition: background 0.3s; overflow-y: auto;
        }
        .logo {
            font-size: 1.5rem; font-weight: 900; color: var(--primary);
            margin-bottom: 20px; display: flex; align-items: center; gap: 10px;
        }

        .profile-section {
            background: var(--secondary); padding: 15px; border-radius: 15px;
            margin-bottom: 20px; border: 1px solid var(--border-color);
        }
        .profile-header { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        .profile-avatar { width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: white; }
        .profile-info h4 { margin: 0; font-size: 1rem; color: var(--text-main); }
        .profile-rank { font-size: 0.8rem; color: var(--text-muted); }
        
        .xp-container { margin-top: 10px; }
        .xp-bar-bg { height: 8px; background: var(--border-color); border-radius: 4px; overflow: hidden; }
        .xp-bar-fill { height: 100%; background: linear-gradient(90deg, var(--primary), var(--success)); width: 0%; transition: width 0.5s; }
        .xp-text { font-size: 0.75rem; color: var(--text-muted); text-align: right; margin-top: 4px; }

        /* Achievements */
        .achievements-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; margin-top: 10px; }
        .ach-badge {
            aspect-ratio: 1; background: var(--border-color); border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem; color: var(--text-muted); opacity: 0.3;
            cursor: help; position: relative; transition: 0.3s;
        }
        .ach-badge.unlocked {
            background: linear-gradient(135deg, #fbbf24, #d97706);
            color: white; opacity: 1; box-shadow: 0 4px 10px rgba(245, 158, 11, 0.3);
            transform: scale(1.05);
        }
        .ach-badge:hover::after {
            content: attr(title); position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%);
            background: #000; color: #fff; padding: 5px 10px; border-radius: 5px;
            font-size: 0.7rem; white-space: nowrap; z-index: 20; pointer-events: none;
        }

        .theme-toggle {
            display: flex; align-items: center; justify-content: space-between;
            background: var(--secondary); padding: 10px 15px; border-radius: 12px;
            margin-top: 20px; cursor: pointer; border: 1px solid var(--border-color); color: var(--text-main);
        }

        .nav-btn {
            width: 100%; text-align: left; padding: 12px 15px; margin-bottom: 5px;
            border: none; background: transparent; border-radius: 10px;
            cursor: pointer; color: var(--text-muted); font-family: 'Sarabun', sans-serif;
            font-size: 0.95rem; font-weight: 600; transition: all 0.2s;
            display: flex; align-items: center; gap: 10px;
        }
        .nav-btn:hover { background: var(--secondary); color: var(--text-main); transform: translateX(5px); }
        .nav-btn.active { background: var(--secondary); color: var(--primary); border-left: 4px solid var(--primary); }

        /* --- MAIN CONTENT --- */
        .main-content { flex-grow: 1; padding: 40px 60px; overflow-y: auto; scroll-behavior: smooth; position: relative; z-index: 5; }
        .page-section { display: none; animation: slideUp 0.5s ease; max-width: 1000px; margin: 0 auto; }
        .page-section.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Hero & Cards */
        .hero-card {
            background: var(--bg-card); border-radius: 25px; padding: 40px;
            box-shadow: 0 10px 40px var(--shadow); border: 1px solid var(--border-color);
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 30px; position: relative; overflow: hidden;
        }
        .hero-card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 6px; height: 100%;
            background: linear-gradient(to bottom, var(--primary), var(--accent));
        }
        .typing-text {
            font-size: 2.2rem; font-weight: 800; color: var(--text-main);
            border-right: 4px solid var(--primary); white-space: nowrap; overflow: hidden;
            animation: typing 3.5s steps(40, end), blink .75s step-end infinite;
        }
        @keyframes typing { from { width: 0 } to { width: 100% } }
        @keyframes blink { from, to { border-color: transparent } 50% { border-color: var(--primary) } }

        /* Why Us Grid */
        .feature-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .feature-card {
            background: var(--bg-card); padding: 20px; border-radius: 15px; border: 1px solid var(--border-color);
            text-align: center; transition: 0.3s;
        }
        .feature-card:hover { transform: translateY(-5px); border-color: var(--primary); box-shadow: 0 10px 20px var(--shadow); }
        .fc-icon { width: 60px; height: 60px; background: var(--secondary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; font-size: 1.5rem; color: var(--primary); }

        /* Tip System */
        .tip-system {
            background: linear-gradient(135deg, var(--success), #059669);
            color: white; border-radius: 20px; padding: 30px;
            margin-bottom: 30px; box-shadow: 0 15px 30px rgba(16, 185, 129, 0.2); position: relative; overflow: hidden;
        }
        .tip-system::after { content: 'üí°'; position: absolute; right: -20px; bottom: -30px; font-size: 10rem; opacity: 0.2; transform: rotate(15deg); }
        .refresh-btn { background: rgba(255,255,255,0.2); border: none; color: white; padding: 8px 15px; border-radius: 20px; cursor: pointer; transition: 0.2s; position: relative; z-index: 2; }
        .refresh-btn:hover { background: white; color: var(--success); }

        /* Creator Box */
        .creator-box {
            background: var(--primary);
            background-image: linear-gradient(45deg, rgba(255,255,255,0.1) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.1) 75%, transparent 75%, transparent);
            background-size: 60px 60px; animation: moveStripes 3s linear infinite;
            color: white; padding: 40px; border-radius: 20px; text-align: center;
            box-shadow: 0 15px 35px rgba(37, 99, 235, 0.3);
        }
        @keyframes moveStripes { 0% { background-position: 0 0; } 100% { background-position: 60px 60px; } }

        /* General */
        h1 { color: var(--primary); border-bottom: 2px solid var(--border-color); padding-bottom: 10px; }
        h2, h3 { color: var(--text-main); } p { color: var(--text-muted); }
        .lesson-card { background: var(--bg-card); padding: 30px; border-radius: 12px; box-shadow: 0 2px 5px var(--shadow); margin-bottom: 30px; border-left: 4px solid var(--info); border: 1px solid var(--border-color); }
        
        /* Checklist */
        .checklist-item {
            display: flex; align-items: center; gap: 15px; background: var(--secondary);
            padding: 15px; border-radius: 10px; margin-bottom: 10px; cursor: pointer; transition: 0.2s;
            color: var(--text-main);
        }
        .checklist-item.checked { background: #dcfce7; }
        body.dark-mode .checklist-item.checked { background: #064e3b; }
        .cb-box { width: 24px; height: 24px; border: 2px solid var(--text-muted); border-radius: 6px; display: flex; align-items: center; justify-content: center; color: transparent; transition: 0.2s; }
        .checklist-item.checked .cb-box { background: var(--success); border-color: var(--success); color: white; }

        /* Game & Signs */
        .game-area { background: var(--bg-card); border-radius: 25px; padding: 50px; text-align: center; box-shadow: 0 10px 30px var(--shadow); border: 1px solid var(--border-color); }
        .timer-bar { background: var(--border-color); height: 10px; border-radius: 5px; overflow: hidden; margin: 20px 0; }
        .timer-fill { background: var(--danger); height: 100%; width: 100%; transition: width 1s linear; }
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 25px; }
        .opt-btn { padding: 20px; border: 2px solid var(--border-color); background: var(--bg-card); color: var(--text-main); border-radius: 12px; font-size: 1.1rem; cursor: pointer; transition: 0.2s; }
        .opt-btn:hover { background: var(--secondary); border-color: var(--primary); transform: scale(1.02); }
        .sign-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .sign-card { background: var(--bg-card); border: 1px solid var(--border-color); padding: 20px; border-radius: 15px; display: flex; gap: 15px; transition: transform 0.2s; }
        .sign-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px var(--shadow); }
        .sign-icon { background: var(--secondary); padding: 10px; border-radius: 10px; display:flex; align-items:center; justify-content:center; width: 60px; height:60px; }
        .sign-icon img { width: 100%; height: 100%; object-fit: contain; }
        .badge { font-size: 0.75rem; padding: 2px 8px; border-radius: 4px; font-weight: bold; margin-bottom: 5px; display: inline-block; color:white; }
        .bg-red { background: var(--danger); } .bg-yellow { background: var(--accent); } .bg-blue { background: var(--primary); }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab-btn { padding: 8px 20px; border-radius: 20px; border: 1px solid var(--border-color); background: var(--bg-card); color: var(--text-muted); cursor: pointer; }
        .tab-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* Toast */
        #toast {
            visibility: hidden; min-width: 250px; background-color: #333; color: #fff; text-align: center; border-radius: 50px;
            padding: 16px; position: fixed; z-index: 10000; left: 50%; bottom: 30px; transform: translateX(-50%); font-size: 1rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
    </style>
</head>
<body>

    <audio id="welcome-sound" src="download.wav" preload="auto"></audio>
    <audio id="sfx-click" src="click.mp3" preload="auto"></audio>
    <audio id="sfx-correct" src="correct.mp3" preload="auto"></audio>
    <audio id="sfx-wrong" src="wrong.mp3" preload="auto"></audio>

    <div id="welcome-overlay">
        <div class="welcome-box">
            <div style="font-size: 5rem; margin-bottom: 15px; animation: floatUp 3s infinite;">üö¶</div>
            <h1 style="font-size: 2.5rem; margin: 0 0 10px 0; background: -webkit-linear-gradient(#60a5fa, #2563eb); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Traffic Master Pro</h1>
            <p style="color: #cbd5e1; margin-bottom: 30px; font-size: 1.1rem;">‡∏™‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏£‡∏≤‡∏à‡∏£ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∞‡∏™‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
            <button class="welcome-btn" onclick="enterSite()">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</button>
        </div>
    </div>

    <div id="toast"><i class="fas fa-trophy" style="color: #fbbf24;"></i> <span id="toast-msg">‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</span></div>

    <div class="bg-animation">
        <div class="floating-item item-1">üõë</div> <div class="floating-item item-2">üö¶</div>
        <div class="floating-item item-3">üöó</div> <div class="floating-item item-4">üöß</div>
    </div>

    <aside class="sidebar">
        <div class="logo"><i class="fas fa-traffic-light"></i> Traffic Master</div>
        
        <div class="profile-section">
            <div class="profile-header">
                <div class="profile-avatar"><i class="fas fa-user-astronaut"></i></div>
                <div class="profile-info">
                    <h4 id="user-level-name">Rookie</h4>
                    <div class="profile-rank" id="user-level">Level 1</div>
                </div>
            </div>
            <div class="xp-container">
                <div class="xp-bar-bg"><div id="xp-fill" class="xp-bar-fill" style="width: 0%"></div></div>
                <div class="xp-text"><span id="xp-current">0</span> / 100 XP</div>
            </div>
            <div class="achievements-grid">
                <div class="ach-badge" id="ach-1" title="‡∏ô‡∏±‡∏Å‡∏≠‡πà‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà"><i class="fas fa-book-open"></i></div>
                <div class="ach-badge" id="ach-2" title="‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà"><i class="fas fa-car"></i></div>
                <div class="ach-badge" id="ach-3" title="‡πÄ‡∏ó‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏à‡∏£‡∏≤‡∏à‡∏£"><i class="fas fa-crown"></i></div>
            </div>
        </div>

        <button class="nav-btn active" onclick="switchPage('home')"><span>üè†</span> ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
        <div class="menu-label">‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
        <button class="nav-btn" onclick="switchPage('lesson-1')"><span>üìñ</span> 1. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</button>
        <button class="nav-btn" onclick="switchPage('lesson-2')"><span>üõë</span> 2. ‡∏Ñ‡∏•‡∏±‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏£‡∏≤‡∏à‡∏£</button>
        <button class="nav-btn" onclick="switchPage('lesson-3')"><span>üìù</span> 3. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≠‡∏ö</button>
        <button class="nav-btn" onclick="switchPage('game')"><span>üéÆ</span> 4. ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>

        <div class="theme-toggle" onclick="toggleTheme()">
            <span><i class="fas fa-adjust"></i> ‡∏ò‡∏µ‡∏°‡∏°‡∏∑‡∏î/‡∏™‡∏ß‡πà‡∏≤‡∏á</span>
            <i id="theme-icon" class="fas fa-moon"></i>
        </div>
    </aside>

    <main class="main-content">
        
        <div id="home" class="page-section active">
            <div class="hero-card">
                <div>
                    <div style="font-size: 0.9rem; color: var(--primary); font-weight: 600; margin-bottom: 5px;">MONTHACHAI DRIVING SCHOOL</div>
                    <div class="typing-text">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà Traffic Learning Hub</div>
                    <p style="margin-top: 15px; max-width: 600px;">
                        ‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢ ‡∏™‡∏ô‡∏∏‡∏Å‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏° ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á
                        <br>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏é‡∏à‡∏£‡∏≤‡∏à‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≠‡∏ö‡πÉ‡∏ö‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà‡πÑ‡∏õ‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!
                    </p>
                </div>
                <div style="font-size: 6rem; opacity: 0.8;">üèÅ</div>
            </div>

            <h3 style="margin-bottom: 15px;"><i class="fas fa-star" style="color: var(--accent);"></i> ‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á Traffic Master?</h3>
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="fc-icon"><i class="fas fa-gamepad"></i></div>
                    <h4>‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏ô‡∏∏‡∏Å‡∏°‡∏µ‡πÄ‡∏•‡πÄ‡∏ß‡∏•</h4>
                    <p style="font-size:0.9rem;">‡∏™‡∏∞‡∏™‡∏° XP ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏¢‡∏® ‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ï‡∏£‡∏≤</p>
                </div>
                <div class="feature-card">
                    <div class="fc-icon"><i class="fas fa-mobile-alt"></i></div>
                    <h4>‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏á‡πà‡∏≤‡∏¢‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡πà</h4>
                    <p style="font-size:0.9rem;">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡πÅ‡∏ó‡πá‡∏ö‡πÄ‡∏•‡πá‡∏ï ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</p>
                </div>
                <div class="feature-card">
                    <div class="fc-icon"><i class="fas fa-check-circle"></i></div>
                    <h4>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏±‡∏ß‡∏£‡πå 100%</h4>
                    <p style="font-size:0.9rem;">‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏£‡∏≤‡∏à‡∏£‡πÑ‡∏ó‡∏¢</p>
                </div>
                <div class="feature-card">
                    <div class="fc-icon"><i class="fas fa-graduation-cap"></i></div>
                    <h4>‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≠‡∏ö‡∏à‡∏£‡∏¥‡∏á</h4>
                    <p style="font-size:0.9rem;">‡∏°‡∏µ‡πÅ‡∏ô‡∏ß‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥‡πÄ‡∏û‡∏µ‡∏¢‡∏ö</p>
                </div>
            </div>

            <div class="tip-system">
                <div class="tip-header">
                    <div style="font-weight: 800; font-size: 1.2rem;"><i class="fas fa-lightbulb"></i> ‡πÄ‡∏Å‡∏£‡πá‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</div>
                    <button class="refresh-btn" onclick="manualRefreshTip()"><i class="fas fa-sync-alt"></i> ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</button>
                </div>
                <div id="tip-content" style="font-size: 1.3rem; font-weight: 500; line-height: 1.5;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
            </div>

            <div class="creator-box" style="margin-top: 40px;">
                 <p style="opacity: 0.9;">DEVELOPED BY</p>
                 <h2 style="margin: 5px 0 10px; font-size: 2rem;">‡∏°‡∏ô‡∏†‡∏ß‡∏±‡∏ï ‡∏ò‡∏±‡∏ç‡∏ç‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå</h2>
                 <p style="font-size: 0.9rem;">‡∏Ñ‡∏ì‡∏∞‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏£‡∏≤‡∏à‡∏£</p>
            </div>
        </div>

        <div id="lesson-1" class="page-section">
            <h1>üìñ 1. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏£‡∏≤‡∏à‡∏£</h1>
            
            <div class="lesson-card">
                <h2>üìú 1. ‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏ó‡∏≤‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ (Legal Definition)</h2>
                <p>‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å <em>‡∏ß‡∏¥‡∏Å‡∏¥‡∏û‡∏µ‡πÄ‡∏î‡∏µ‡∏¢ ‡∏™‡∏≤‡∏£‡∏≤‡∏ô‡∏∏‡∏Å‡∏£‡∏°‡πÄ‡∏™‡∏£‡∏µ</em> ‡πÅ‡∏•‡∏∞ <em>‡∏û.‡∏£.‡∏ö. ‡∏à‡∏£‡∏≤‡∏à‡∏£‡∏ó‡∏≤‡∏á‡∏ö‡∏Å ‡∏û.‡∏®. 2522</em> ‡πÑ‡∏î‡πâ‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏ß‡πâ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:</p>
                <div style="background: var(--secondary); padding: 15px; border-left: 4px solid var(--primary); border-radius: 5px; margin: 15px 0;">
                    <p style="margin: 0; font-style: italic; color: var(--text-main);">
                        "<strong>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏£‡∏≤‡∏à‡∏£ (Traffic Sign)</strong> ‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏î‡πÜ ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏ô‡∏ó‡∏≤‡∏á ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà ‡∏Ñ‡∏ô‡πÄ‡∏î‡∏¥‡∏ô‡πÄ‡∏ó‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏π‡∏á ‡∏Ç‡∏µ‡πà ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏•‡πà‡∏ï‡πâ‡∏≠‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ô‡∏±‡πâ‡∏ô"
                    </p>
                </div>
                <p><strong>‡∏™‡∏≤‡∏£‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</strong> ‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏£‡∏≤‡∏à‡∏£‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô <strong>"‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢"</strong> ‡∏´‡∏≤‡∏Å‡∏ù‡πà‡∏≤‡∏ù‡∏∑‡∏ô‡∏õ‡πâ‡∏≤‡∏¢‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏à‡∏∞‡∏°‡∏µ‡πÇ‡∏ó‡∏©‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</p>
            </div>

            <div class="lesson-card" style="border-left-color: var(--accent);">
                <h2>üåç 2. ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡∏≤‡∏Å‡∏• (International Standard)</h2>
                <p>‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢‡πÉ‡∏ä‡πâ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏£‡∏≤‡∏à‡∏£‡∏ó‡∏µ‡πà‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å <strong>‡∏≠‡∏ô‡∏∏‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏ô‡∏≤‡∏ß‡πà‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏à‡∏£‡∏≤‡∏à‡∏£</strong> ‡∏ú‡∏™‡∏°‡∏ú‡∏™‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô MUTCD ‡∏Ç‡∏≠‡∏á‡∏™‡∏´‡∏£‡∏±‡∏ê‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πà‡∏ß‡πÇ‡∏•‡∏Å‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ú‡πà‡∏≤‡∏ô "‡∏†‡∏≤‡∏©‡∏≤‡∏™‡∏≤‡∏Å‡∏•" 3 ‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏Ñ‡∏∑‡∏≠:</p>
                <ul style="list-style: none; padding: 0; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                    <li style="background: var(--secondary); padding: 10px; border-radius: 8px;"><i class="fas fa-shapes" style="color:var(--primary);"></i> <strong>‡∏£‡∏π‡∏õ‡∏ó‡∏£‡∏á (Shapes)</strong></li>
                    <li style="background: var(--secondary); padding: 10px; border-radius: 8px;"><i class="fas fa-palette" style="color:var(--accent);"></i> <strong>‡∏™‡∏µ (Colors)</strong></li>
                    <li style="background: var(--secondary); padding: 10px; border-radius: 8px;"><i class="fas fa-icons" style="color:var(--danger);"></i> <strong>‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå (Symbols)</strong></li>
                </ul>
            </div>

            <div class="lesson-card" style="border-left-color: var(--danger);">
                <h2>üìê 3. ‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™‡∏•‡∏±‡∏ö "‡∏£‡∏π‡∏õ‡∏ó‡∏£‡∏á" ‡∏Ç‡∏≠‡∏á‡∏õ‡πâ‡∏≤‡∏¢</h2>
                <p>‡∏£‡∏π‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡πÅ‡∏Ñ‡πà‡πÄ‡∏´‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏ó‡∏£‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏¢‡∏∞‡πÑ‡∏Å‡∏• ‡∏Å‡πá‡∏£‡∏π‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£!</p>
                <div style="display: flex; flex-direction: column; gap: 15px; margin-top: 15px;">
                    <div style="display: flex; align-items: center; gap: 15px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">
                        <div style="font-size: 2.5rem; color: var(--danger);"><i class="fas fa-circle"></i></div>
                        <div>
                            <strong style="color:var(--text-main);">‡∏ß‡∏á‡∏Å‡∏•‡∏° (Circle)</strong>
                            <br><span style="font-size: 0.9rem;">‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á <strong>"‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á"</strong> ‡∏´‡∏£‡∏∑‡∏≠ <strong>"‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö"</strong> (‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥/‡∏´‡πâ‡∏≤‡∏°‡∏ó‡∏≥)</span>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 15px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">
                        <div style="font-size: 2.5rem; color: var(--accent); transform: rotate(45deg);"><i class="fas fa-square"></i></div>
                        <div>
                            <strong style="color:var(--text-main);">‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏Ç‡∏ô‡∏°‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å‡∏õ‡∏π‡∏ô (Diamond)</strong>
                            <br><span style="font-size: 0.9rem;">‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á <strong>"‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô"</strong> (Warning) ‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤</span>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 15px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">
                        <div style="font-size: 2.5rem; color: var(--danger);"><i class="fas fa-stop-circle"></i></div>
                        <div>
                            <strong style="color:var(--text-main);">‡πÅ‡∏õ‡∏î‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏° (Octagon)</strong>
                            <br><span style="font-size: 0.9rem;">‡∏°‡∏µ‡∏õ‡πâ‡∏≤‡∏¢‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÉ‡∏ô‡πÇ‡∏•‡∏Å‡∏Ñ‡∏∑‡∏≠ <strong>"‡∏õ‡πâ‡∏≤‡∏¢‡∏´‡∏¢‡∏∏‡∏î (STOP)"</strong></span>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div style="font-size: 2.5rem; color: var(--danger); transform: rotate(180deg);"><i class="fas fa-play"></i></div>
                        <div>
                            <strong style="color:var(--text-main);">‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏´‡∏±‡∏ß‡∏Å‡∏•‡∏±‡∏ö (Inverted Triangle)</strong>
                            <br><span style="font-size: 0.9rem;">‡∏Ñ‡∏∑‡∏≠‡∏õ‡πâ‡∏≤‡∏¢ <strong>"‡πÉ‡∏´‡πâ‡∏ó‡∏≤‡∏á (Yield)"</strong> ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏∞‡∏•‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏ñ‡∏ó‡∏≤‡∏á‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô</span>
                        </div>
                    </div>
                </div>
            </div>

            <button class="welcome-btn" style="width:100%; font-size:1rem; padding:10px;" onclick="gainXP(50); this.disabled=true; this.innerText='‚úÖ ‡∏£‡∏±‡∏ö 50 XP ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'; playSFX('sfx-correct');">
                <i class="fas fa-check-circle"></i> ‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡∏Å‡∏î‡∏£‡∏±‡∏ö 50 XP!
            </button>
        </div>

        <div id="lesson-2" class="page-section">
            <h1>üõë 2. ‡∏Ñ‡∏•‡∏±‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏£‡∏≤‡∏à‡∏£‡πÅ‡∏•‡∏∞‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞</h1>

            <div class="lesson-card" style="border-left-color: var(--danger);">
                <h3>üî¥ ‡∏õ‡πâ‡∏≤‡∏¢‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö (Regulatory Signs)</h3>
                <p>‡∏Ñ‡∏∑‡∏≠‡∏õ‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏£‡∏≤‡∏à‡∏£‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏≤‡∏á <strong>"‡∏ï‡πâ‡∏≠‡∏á"</strong> ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡πà‡∏á‡∏Ñ‡∏£‡∏±‡∏î ‡∏´‡∏≤‡∏Å‡∏ù‡πà‡∏≤‡∏ù‡∏∑‡∏ô‡∏à‡∏∞‡∏°‡∏µ‡πÇ‡∏ó‡∏©‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢</p>
                <ul>
                    <li><strong>‡∏õ‡πâ‡∏≤‡∏¢‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå:</strong> ‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡πâ‡∏≤‡∏¢‡∏´‡∏¢‡∏∏‡∏î, ‡∏õ‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ó‡∏≤‡∏á</li>
                    <li><strong>‡∏õ‡πâ‡∏≤‡∏¢‡∏´‡πâ‡∏≤‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå:</strong> ‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤, ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏ß, ‡∏´‡πâ‡∏≤‡∏°‡∏à‡∏≠‡∏î</li>
                    <li><strong>‡∏õ‡πâ‡∏≤‡∏¢‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á:</strong> ‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏ß‡∏ã‡πâ‡∏≤‡∏¢, ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡πÑ‡∏õ, ‡πÄ‡∏î‡∏¥‡∏ô‡∏£‡∏ñ‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</li>
                </ul>
            </div>

            <div class="lesson-card" style="border-left-color: var(--accent);">
                <h3>üü° ‡∏õ‡πâ‡∏≤‡∏¢‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (Warning Signs)</h3>
                <p>‡∏°‡∏µ‡πÑ‡∏ß‡πâ‡πÅ‡∏à‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏™‡∏†‡∏≤‡∏û‡∏ñ‡∏ô‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∞‡∏•‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß</p>
                <ul>
                    <li><strong>‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏á/‡∏ó‡∏≤‡∏á‡πÅ‡∏¢‡∏Å:</strong> ‡πÇ‡∏Ñ‡πâ‡∏á‡∏£‡∏±‡∏®‡∏°‡∏µ‡πÅ‡∏Ñ‡∏ö, ‡∏ó‡∏≤‡∏á‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤</li>
                    <li><strong>‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏†‡∏≤‡∏û‡∏ñ‡∏ô‡∏ô:</strong> ‡∏ú‡∏¥‡∏ß‡∏ó‡∏≤‡∏á‡∏Ç‡∏£‡∏∏‡∏Ç‡∏£‡∏∞, ‡∏ó‡∏≤‡∏á‡∏•‡∏∑‡πà‡∏ô, ‡∏™‡∏∞‡∏û‡∏≤‡∏ô‡πÅ‡∏Ñ‡∏ö</li>
                </ul>
            </div>

            <div class="lesson-card" style="border-left-color: var(--primary);">
                <h3>üîµ ‡∏õ‡πâ‡∏≤‡∏¢‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (Guide Signs)</h3>
                <p>‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á ‡∏ö‡∏≠‡∏Å‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á ‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</p>
            </div>

            <hr style="margin: 40px 0; border: 0; border-top: 2px dashed var(--border-color);">

            <h2>üì∏ ‡∏Ñ‡∏•‡∏±‡∏á‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏à‡∏£‡∏≤‡∏à‡∏£</h2>
            <div class="tabs">
                <button class="tab-btn active" onclick="filterSigns('all')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                <button class="tab-btn" onclick="filterSigns('mandatory')">‡∏õ‡πâ‡∏≤‡∏¢‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö</button>
                <button class="tab-btn" onclick="filterSigns('warning')">‡∏õ‡πâ‡∏≤‡∏¢‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</button>
                <button class="tab-btn" onclick="filterSigns('info')">‡∏õ‡πâ‡∏≤‡∏¢‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</button>
            </div>
            <div id="sign-container" class="sign-grid"></div>
        </div>

        <div id="lesson-3" class="page-section">
            <h1>üìù 3. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≠‡∏ö‡πÉ‡∏ö‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà</h1>
            <div class="lesson-card">
                <h2><i class="fas fa-clipboard-check"></i> Checklist ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°</h2>
                <div class="checklist-item" onclick="toggleCheck(this)"><div class="cb-box"><i class="fas fa-check"></i></div><div>‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á (‡∏â‡∏ö‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á)</div></div>
                <div class="checklist-item" onclick="toggleCheck(this)"><div class="cb-box"><i class="fas fa-check"></i></div><div>‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå (‡∏≠‡∏≤‡∏¢‡∏∏‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</div></div>
                <div class="checklist-item" onclick="toggleCheck(this)"><div class="cb-box"><i class="fas fa-check"></i></div><div>‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢‡∏™‡∏∏‡∏†‡∏≤‡∏û (‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á‡∏Ç‡∏≤‡∏™‡∏±‡πâ‡∏ô/‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡πÅ‡∏ï‡∏∞)</div></div>
                <div class="checklist-item" onclick="toggleCheck(this)"><div class="cb-box"><i class="fas fa-check"></i></div><div>‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ú‡πà‡∏≤‡∏ô DLT Smart Queue</div></div>
            </div>
        </div>

        <div id="game" class="page-section">
            <h1>üéÆ 4. ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h1>
            <div class="game-area">
                <div id="g-start">
                    <div style="font-size: 6rem; margin-bottom: 20px;">üèÜ</div>
                    <h2>‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á?</h2>
                    <p>‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏•‡∏∞ 20 XP! ‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏´‡∏°‡∏î‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ó‡∏≠‡∏á!</p>
                    <button class="welcome-btn" onclick="startGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö</button>
                </div>
                <div id="g-play" style="display:none;">
                    <div style="display:flex; justify-content:space-between; color:var(--text-muted);">
                        <span id="q-counter">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1/5</span> <span id="timer-text">30s</span>
                    </div>
                    <div class="timer-bar"><div id="timer-fill" class="timer-fill"></div></div>
                    <div id="q-icon" style="margin: 20px 0; font-size: 5rem;"><img src="" style="width:120px;"></div>
                    <h3 id="q-question">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°?</h3>
                    <div id="q-options" class="options-grid"></div>
                </div>
                <div id="g-result" style="display:none;">
                    <h2>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h2>
                    <h1 style="color:var(--primary); font-size:5rem; margin: 20px 0;" id="final-score">0/5</h1>
                    <p id="xp-gained-text" style="font-weight:bold; color:var(--success); font-size:1.2rem;">+0 XP</p>
                    <button class="welcome-btn" style="background:transparent; border:2px solid var(--primary); color:var(--primary); box-shadow:none;" onclick="startGame()">‡∏™‡∏≠‡∏ö‡πÅ‡∏Å‡πâ‡∏ï‡∏±‡∏ß</button>
                </div>
            </div>
        </div>
    </main>

    <script>
        // --- SFX SYSTEM ---
        function playSFX(id) { const sfx = document.getElementById(id); if(sfx) { sfx.currentTime = 0; sfx.play().catch(()=>{}); } }

        // --- THEME SYSTEM ---
        let isDarkMode = localStorage.getItem('darkMode') === 'true';
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode', isDarkMode);
            document.getElementById('theme-icon').className = isDarkMode ? 'fas fa-sun' : 'fas fa-moon';
            localStorage.setItem('darkMode', isDarkMode);
            playSFX('sfx-click');
        }
        if(isDarkMode) { document.body.classList.add('dark-mode'); document.getElementById('theme-icon').className = 'fas fa-sun'; }

        // --- PROFILE & XP ---
        let userXP = parseInt(localStorage.getItem('userXP')) || 0;
        let achievements = JSON.parse(localStorage.getItem('achievements')) || [];
        const xpPerLevel = 100;
        const rankNames = ["Rookie", "Junior", "Senior", "Master", "Legend"];

        function updateProfileUI() {
            let level = Math.floor(userXP / xpPerLevel) + 1;
            let xpPercent = (userXP % xpPerLevel);
            document.getElementById('user-level').innerText = `Level ${level}`;
            document.getElementById('user-level-name').innerText = rankNames[Math.min(level-1, 4)];
            document.getElementById('xp-current').innerText = userXP % xpPerLevel;
            document.getElementById('xp-fill').style.width = `${xpPercent}%`;
            localStorage.setItem('userXP', userXP);
            
            if(achievements.includes('1')) document.getElementById('ach-1').classList.add('unlocked');
            if(achievements.includes('2')) document.getElementById('ach-2').classList.add('unlocked');
            if(achievements.includes('3')) document.getElementById('ach-3').classList.add('unlocked');
        }

        function unlockAchievement(id, text) {
            if(!achievements.includes(id)) {
                achievements.push(id);
                localStorage.setItem('achievements', JSON.stringify(achievements));
                updateProfileUI();
                showToast(`üèÜ ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ: ${text}`);
                playSFX('sfx-correct');
                confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
            }
        }

        function gainXP(amount) { userXP += amount; updateProfileUI(); }

        function showToast(text) {
            const toast = document.getElementById("toast");
            document.getElementById("toast-msg").innerText = text;
            toast.className = "show";
            setTimeout(function(){ toast.className = toast.className.replace("show", ""); }, 3000);
        }

        function toggleCheck(el) { el.classList.toggle('checked'); playSFX('sfx-click'); }

        // --- CORE SYSTEM & AUTO TIPS ---
        let autoTipTimer;
        
        function enterSite() {
            document.getElementById('welcome-sound').play().catch(()=>{});
            document.getElementById('welcome-overlay').style.opacity = '0';
            setTimeout(() => { document.getElementById('welcome-overlay').style.display = 'none'; }, 500);
            unlockAchievement('1', '‡∏ô‡∏±‡∏Å‡∏≠‡πà‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà'); 
            randomTip(); 
            autoTipTimer = setInterval(randomTip, 10000); // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ó‡∏∏‡∏Å 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
        }

        function switchPage(pageId) {
            playSFX('sfx-click');
            document.querySelectorAll('.page-section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            
            const btnMap = { 'home': 0, 'lesson-1': 1, 'lesson-2': 2, 'lesson-3': 3, 'game': 4 };
            if(document.querySelectorAll('.nav-btn')[btnMap[pageId]]) {
                document.querySelectorAll('.nav-btn')[btnMap[pageId]].classList.add('active');
            }
            window.scrollTo(0,0);
        }

        const tips = [
            "üí° ‡∏ó‡∏≤‡∏á‡∏°‡πâ‡∏≤‡∏•‡∏≤‡∏¢: ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏ñ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏Ç‡πâ‡∏≤‡∏°‡πÄ‡∏™‡∏°‡∏≠ ‡∏´‡∏≤‡∏Å‡∏ù‡πà‡∏≤‡∏ù‡∏∑‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 4,000 ‡∏ö‡∏≤‡∏ó",
            "üí° ‡πÑ‡∏ü‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á: ‡πÉ‡∏´‡πâ‡∏ä‡∏∞‡∏•‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏ñ ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß!",
            "üí° ‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏∂‡∏ö: ‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏ã‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏•‡∏ô‡πÇ‡∏î‡∏¢‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏",
            "üí° ‡∏ó‡∏≤‡∏á‡πÅ‡∏¢‡∏Å‡∏ß‡∏±‡∏î‡πÉ‡∏à: ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÑ‡∏ü ‡πÉ‡∏´‡πâ‡∏£‡∏ñ‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏™‡∏°‡∏≠",
            "üí° ‡∏ù‡∏ô‡∏ï‡∏Å‡∏ñ‡∏ô‡∏ô‡∏•‡∏∑‡πà‡∏ô: ‡∏Ñ‡∏ß‡∏£‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥ 2 ‡πÄ‡∏ó‡πà‡∏≤",
            "üí° ‡πÄ‡∏°‡∏≤‡πÑ‡∏°‡πà‡∏Ç‡∏±‡∏ö: ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 50 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏Å‡∏£‡∏±‡∏°‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå (20 mg% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà)",
            "üí° ‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡∏±‡∏ö‡∏£‡∏ñ: ‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏£‡∏ñ‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞ 100 ‡πÄ‡∏°‡∏ï‡∏£ ‡∏à‡∏≤‡∏Å‡∏ó‡∏≤‡∏á‡∏£‡∏≤‡∏ö ‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡∏∞‡∏û‡∏≤‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏á"
        ];
        
        function randomTip() {
            const tip = document.getElementById('tip-content');
            tip.style.opacity = 0;
            setTimeout(() => { 
                tip.innerText = tips[Math.floor(Math.random()*tips.length)]; 
                tip.style.opacity = 1; 
            }, 200);
        }

        function manualRefreshTip() {
            playSFX('sfx-click');
            randomTip();
            clearInterval(autoTipTimer);
            autoTipTimer = setInterval(randomTip, 10000); // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏≠‡∏á
        }

        // --- DATA & GALLERY ---
        const trafficData = [
            // *‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏¢‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì*
            { type: 'mandatory', icon: '<img src="‡∏´‡∏¢‡∏∏‡∏î‡∏î.png" alt="‡∏õ‡πâ‡∏≤‡∏¢‡∏´‡∏¢‡∏∏‡∏î">', name: '‡∏õ‡πâ‡∏≤‡∏¢‡∏´‡∏¢‡∏∏‡∏î', desc: '‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏ñ‡πÉ‡∏´‡πâ‡∏™‡∏ô‡∏¥‡∏ó‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏´‡∏¢‡∏∏‡∏î' },
            { type: 'mandatory', icon: 'üîª', name: '‡∏õ‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ó‡∏≤‡∏á', desc: '‡πÉ‡∏´‡πâ‡∏£‡∏ñ‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô' },
            { type: 'mandatory', icon: '‚õî', name: '‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤', desc: '‡∏´‡πâ‡∏≤‡∏°‡∏£‡∏ñ‡∏ó‡∏∏‡∏Å‡∏ä‡∏ô‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ' },
            { type: 'mandatory', icon: 'üö´', name: '‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏ß‡∏ã‡πâ‡∏≤‡∏¢', desc: '‡∏´‡πâ‡∏≤‡∏°‡∏°‡∏¥‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏ß‡∏£‡∏ñ‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢' },
            { type: 'mandatory', icon: 'üö´', name: '‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏£‡∏ñ', desc: '‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏£‡∏ñ' },
            { type: 'mandatory', icon: 'üÖøÔ∏è‚ùå', name: '‡∏´‡πâ‡∏≤‡∏°‡∏à‡∏≠‡∏î‡∏£‡∏ñ', desc: '‡∏´‡πâ‡∏≤‡∏°‡∏à‡∏≠‡∏î‡∏£‡∏ñ‡πÉ‡∏ô‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î' },
            { type: 'warning', icon: '‚Ü™Ô∏è', name: '‡∏ó‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏á‡∏ã‡πâ‡∏≤‡∏¢', desc: '‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß ‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢' },
            { type: 'warning', icon: 'üö¶', name: '‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÑ‡∏ü', desc: '‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡πÑ‡∏ü‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤' },
            { type: 'info', icon: 'üÖøÔ∏è', name: '‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏î‡∏£‡∏ñ', desc: '‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏ô‡∏µ‡πâ‡∏à‡∏≠‡∏î‡∏£‡∏ñ‡πÑ‡∏î‡πâ' }
        ];

        function renderSigns(filterType) {
            const container = document.getElementById('sign-container'); container.innerHTML = '';
            const filtered = filterType === 'all' ? trafficData : trafficData.filter(item => item.type === filterType);
            filtered.forEach(item => {
                let badgeClass = item.type === 'mandatory' ? 'bg-red' : (item.type === 'warning' ? 'bg-yellow' : 'bg-blue');
                let badgeText = item.type === 'mandatory' ? '‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö' : (item.type === 'warning' ? '‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô' : '‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥');
                container.innerHTML += `<div class="sign-card"><div class="sign-icon">${item.icon}</div><div><span class="badge ${badgeClass}">${badgeText}</span><div style="font-weight:bold; color:var(--text-main);">${item.name}</div><div style="font-size:0.9rem; color:var(--text-muted);">${item.desc}</div></div></div>`;
            });
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            // Note: button active state mapping not fully implemented here for brevity, handled by CSS mostly
        }
        function filterSigns(type) { playSFX('sfx-click'); renderSigns(type); }

        // --- GAME LOGIC ---
        let score=0; let qIndex=0; let timer; let timeLeft=30;
        function startGame() {
            playSFX('sfx-click'); score=0; qIndex=0; timeLeft=30;
            document.getElementById('g-start').style.display='none';
            document.getElementById('g-result').style.display='none';
            document.getElementById('g-play').style.display='block';
            nextQuestion();
            clearInterval(timer);
            timer = setInterval(()=>{
                timeLeft--; document.getElementById('timer-text').innerText=timeLeft+'s';
                document.getElementById('timer-fill').style.width=(timeLeft/30*100)+"%";
                if(timeLeft<=0) endGame();
            },1000);
        }
        function nextQuestion() {
            if(qIndex>=5) { endGame(); return; }
            const item = trafficData[Math.floor(Math.random()*trafficData.length)];
            let opts = [item.name];
            while(opts.length<4) {
                const rand = trafficData[Math.floor(Math.random()*trafficData.length)].name;
                if(!opts.includes(rand)) opts.push(rand);
            }
            opts.sort(()=>Math.random()-0.5);
            document.getElementById('q-counter').innerText=`‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${qIndex+1}/5`;
            
            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û <img> ‡∏´‡∏£‡∏∑‡∏≠ ‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡πÄ‡∏Å‡∏°
            if(item.icon.includes('<img')) {
                 document.getElementById('q-icon').innerHTML = item.icon;
            } else {
                 document.getElementById('q-icon').innerHTML = `<div style="font-size: 5rem;">${item.icon}</div>`;
            }

            const c = document.getElementById('q-options'); c.innerHTML='';
            opts.forEach(opt=>{
                const btn=document.createElement('button'); btn.className='opt-btn'; btn.innerText=opt;
                btn.onclick=()=>{ 
                    if(opt===item.name) { score++; playSFX('sfx-correct'); } else { playSFX('sfx-wrong'); }
                    qIndex++; nextQuestion(); 
                };
                c.appendChild(btn);
            });
        }
        function endGame() {
            clearInterval(timer);
            document.getElementById('g-play').style.display='none';
            document.getElementById('g-result').style.display='block';
            document.getElementById('final-score').innerText=score+"/5";
            const xpGained = score * 20;
            document.getElementById('xp-gained-text').innerText = `+${xpGained} XP`;
            gainXP(xpGained);
            unlockAchievement('2', '‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà');
            if(score === 5) {
                unlockAchievement('3', '‡πÄ‡∏ó‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏à‡∏£‡∏≤‡∏à‡∏£');
                confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 } });
            }
        }

        renderSigns('all');
        updateProfileUI();
    </script>
</body>
</html>