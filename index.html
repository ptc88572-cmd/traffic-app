<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Traffic Master Pro - Mobile App</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        /* --- THEME VARIABLES --- */
        :root {
            --primary: #2563eb; --primary-dark: #1d4ed8; --secondary: #eff6ff;
            --bg-main: #f3f4f6; --bg-card: #ffffff; --text-main: #1f2937;
            --text-muted: #6b7280; --border-color: #e5e7eb; --sidebar-bg: #ffffff;
            --accent: #f59e0b; --danger: #dc2626; --success: #10b981;
            --shadow: rgba(0,0,0,0.05); --sidebar-width: 280px;
        }
        body.dark-mode {
            --primary: #3b82f6; --secondary: #1e293b; --bg-main: #0f172a;
            --bg-card: #1e293b; --text-main: #f1f5f9; --text-muted: #94a3b8;
            --border-color: #334155; --sidebar-bg: #111827; --shadow: rgba(0,0,0,0.3);
        }

        body {
            font-family: 'Sarabun', sans-serif; margin: 0; display: flex;
            height: 100vh; overflow: hidden; background: var(--bg-main);
            color: var(--text-main); line-height: 1.6; transition: 0.3s;
        }

        /* --- [NEW] MOBILE RESPONSIVE CSS --- */
        /* ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π (‡∏ã‡πà‡∏≠‡∏ô‡πÉ‡∏ô PC ‡πÇ‡∏ä‡∏ß‡πå‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠) */
        .mobile-toggle {
            display: none; position: fixed; top: 15px; left: 15px; z-index: 100;
            background: var(--primary); color: white; border: none;
            width: 45px; height: 45px; border-radius: 12px; font-size: 1.2rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); cursor: pointer;
        }
        
        /* Overlay ‡∏â‡∏≤‡∏Å‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π */
        .menu-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 40; backdrop-filter: blur(3px);
        }

        /* ‡∏Å‡∏é‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 768px) */
        @media (max-width: 768px) {
            .sidebar {
                position: fixed; left: -100%; top: 0; height: 100%; width: 80%; max-width: 300px;
                transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 5px 0 25px rgba(0,0,0,0.2);
            }
            .sidebar.active { left: 0; } /* ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ */
            .main-content { width: 100%; padding: 80px 20px 40px 20px; } /* ‡πÄ‡∏û‡∏¥‡πà‡∏° Padding ‡∏ö‡∏ô‡∏´‡∏•‡∏ö‡∏õ‡∏∏‡πà‡∏° */
            .mobile-toggle { display: flex; align-items: center; justify-content: center; }
            .menu-overlay.active { display: block; }
            
            /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            .hero-card { flex-direction: column; text-align: center; padding: 25px; }
            .hero-card div:last-child { margin-top: 20px; font-size: 4rem; }
            .typing-text { font-size: 1.5rem; white-space: normal; animation: none; border: none; }
            h1 { font-size: 1.8rem; }
            
            /* ‡∏ã‡πà‡∏≠‡∏ô Animation ‡∏•‡∏≠‡∏¢‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏£‡∏Å‡∏à‡∏≠ */
            .bg-animation { display: none; }
        }

        /* --- SIDEBAR --- */
        .sidebar {
            width: var(--sidebar-width); background: var(--sidebar-bg); border-right: 1px solid var(--border-color);
            display: flex; flex-direction: column; padding: 25px; flex-shrink: 0;
            position: relative; z-index: 50; overflow-y: auto;
        }
        .logo { font-size: 1.5rem; font-weight: 900; color: var(--primary); margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        
        /* Profile & Nav Styles (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) */
        .profile-section { background: var(--secondary); padding: 15px; border-radius: 15px; margin-bottom: 20px; border: 1px solid var(--border-color); }
        .profile-header { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        .profile-avatar { width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: white; }
        .profile-info h4 { margin: 0; font-size: 1rem; color: var(--text-main); }
        .profile-rank { font-size: 0.8rem; color: var(--text-muted); }
        .xp-container { margin-top: 10px; }
        .xp-bar-bg { height: 8px; background: var(--border-color); border-radius: 4px; overflow: hidden; }
        .xp-bar-fill { height: 100%; background: linear-gradient(90deg, var(--primary), var(--success)); width: 0%; transition: width 0.5s; }
        .xp-text { font-size: 0.75rem; color: var(--text-muted); text-align: right; margin-top: 4px; }
        .achievements-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; margin-top: 10px; }
        .ach-badge { aspect-ratio: 1; background: var(--border-color); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; color: var(--text-muted); opacity: 0.3; }
        .ach-badge.unlocked { background: linear-gradient(135deg, #fbbf24, #d97706); color: white; opacity: 1; box-shadow: 0 4px 10px rgba(245, 158, 11, 0.3); }
        .nav-btn { width: 100%; text-align: left; padding: 12px 15px; margin-bottom: 5px; border: none; background: transparent; border-radius: 10px; cursor: pointer; color: var(--text-muted); font-family: 'Sarabun', sans-serif; font-size: 0.95rem; font-weight: 600; display: flex; align-items: center; gap: 10px; }
        .nav-btn.active { background: var(--secondary); color: var(--primary); border-left: 4px solid var(--primary); }
        .theme-toggle { display: flex; align-items: center; justify-content: space-between; background: var(--secondary); padding: 10px 15px; border-radius: 12px; margin-top: 20px; cursor: pointer; border: 1px solid var(--border-color); color: var(--text-main); }

        /* --- MAIN CONTENT --- */
        .main-content { flex-grow: 1; padding: 40px 60px; overflow-y: auto; scroll-behavior: smooth; position: relative; z-index: 5; }
        .page-section { display: none; animation: slideUp 0.5s ease; max-width: 1000px; margin: 0 auto; }
        .page-section.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Components */
        .hero-card { background: var(--bg-card); border-radius: 25px; padding: 40px; box-shadow: 0 10px 40px var(--shadow); border: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; position: relative; overflow: hidden; }
        .feature-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .feature-card { background: var(--bg-card); padding: 20px; border-radius: 15px; border: 1px solid var(--border-color); text-align: center; }
        .fc-icon { width: 60px; height: 60px; background: var(--secondary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; font-size: 1.5rem; color: var(--primary); }
        .tip-system { background: linear-gradient(135deg, var(--success), #059669); color: white; border-radius: 20px; padding: 30px; margin-bottom: 30px; box-shadow: 0 15px 30px rgba(16, 185, 129, 0.2); }
        .refresh-btn { background: rgba(255,255,255,0.2); border: none; color: white; padding: 8px 15px; border-radius: 20px; cursor: pointer; }
        .creator-box { background: var(--primary); color: white; padding: 40px; border-radius: 20px; text-align: center; box-shadow: 0 15px 35px rgba(37, 99, 235, 0.3); }
        .lesson-card { background: var(--bg-card); padding: 30px; border-radius: 12px; box-shadow: 0 2px 5px var(--shadow); margin-bottom: 30px; border-left: 4px solid var(--info); border: 1px solid var(--border-color); }
        .checklist-item { display: flex; align-items: center; gap: 15px; background: var(--secondary); padding: 15px; border-radius: 10px; margin-bottom: 10px; cursor: pointer; color: var(--text-main); }
        .checklist-item.checked { background: #dcfce7; } body.dark-mode .checklist-item.checked { background: #064e3b; }
        .cb-box { width: 24px; height: 24px; border: 2px solid var(--text-muted); border-radius: 6px; display: flex; align-items: center; justify-content: center; color: transparent; }
        .checklist-item.checked .cb-box { background: var(--success); border-color: var(--success); color: white; }
        
        /* Game & Signs */
        .game-area { background: var(--bg-card); border-radius: 25px; padding: 30px; text-align: center; border: 1px solid var(--border-color); }
        .timer-bar { background: var(--border-color); height: 10px; border-radius: 5px; overflow: hidden; margin: 20px 0; }
        .timer-fill { background: var(--danger); height: 100%; width: 100%; transition: width 1s linear; }
        .options-grid { display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 25px; } /* ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô 1 ‡πÅ‡∏ñ‡∏ß‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
        @media(min-width: 768px) { .options-grid { grid-template-columns: 1fr 1fr; } }
        .opt-btn { padding: 15px; border: 2px solid var(--border-color); background: var(--bg-card); color: var(--text-main); border-radius: 12px; font-size: 1rem; cursor: pointer; }
        .sign-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; } /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏£‡∏¥‡∏î */
        .sign-card { background: var(--bg-card); border: 1px solid var(--border-color); padding: 15px; border-radius: 15px; display: flex; flex-direction: column; align-items: center; text-align: center; gap: 10px; }
        .sign-icon { background: var(--secondary); padding: 10px; border-radius: 10px; display:flex; align-items:center; justify-content:center; width: 60px; height:60px; }
        .sign-icon img { width: 100%; height: 100%; object-fit: contain; }
        .badge { font-size: 0.75rem; padding: 2px 8px; border-radius: 4px; font-weight: bold; color:white; }
        .bg-red { background: var(--danger); } .bg-yellow { background: var(--accent); } .bg-blue { background: var(--primary); }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 5px; } /* ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô‡πÑ‡∏î‡πâ */
        .tab-btn { padding: 8px 15px; border-radius: 20px; border: 1px solid var(--border-color); background: var(--bg-card); color: var(--text-muted); cursor: pointer; white-space: nowrap; }
        .tab-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* UI */
        .welcome-btn { margin-top: 30px; padding: 15px 40px; font-size: 1.1rem; background: linear-gradient(90deg, var(--primary), var(--accent)); color: white; border: none; border-radius: 50px; cursor: pointer; font-weight: 800; box-shadow: 0 10px 30px rgba(37, 99, 235, 0.4); }
        #toast { visibility: hidden; min-width: 250px; background-color: #333; color: #fff; text-align: center; border-radius: 50px; padding: 16px; position: fixed; z-index: 10000; left: 50%; bottom: 30px; transform: translateX(-50%); font-size: 1rem; display: flex; align-items: center; justify-content: center; gap: 10px; }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} } @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
        #welcome-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; color: white; text-align: center; }
    </style>
</head>
<body>

    <audio id="welcome-sound" src="download.wav" preload="auto"></audio>
    <audio id="sfx-click" src="click.mp3" preload="auto"></audio>
    <audio id="sfx-correct" src="correct.mp3" preload="auto"></audio>
    <audio id="sfx-wrong" src="wrong.mp3" preload="auto"></audio>

    <div id="welcome-overlay">
        <div style="font-size: 5rem; margin-bottom: 15px;">üö¶</div>
        <h1 style="color:white;">Traffic Master Pro</h1>
        <p style="color: #cbd5e1; margin-bottom: 20px;">‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏é‡∏à‡∏£‡∏≤‡∏à‡∏£‡πÅ‡∏ö‡∏ö‡∏™‡∏ô‡∏∏‡∏Å‡πÜ</p>
        <button class="welcome-btn" onclick="enterSite()">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</button>
    </div>

    <button class="mobile-toggle" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
    <div class="menu-overlay" onclick="toggleSidebar()"></div>

    <div id="toast"><i class="fas fa-trophy" style="color: #fbbf24;"></i> <span id="toast-msg"></span></div>

    <aside class="sidebar">
        <div class="logo"><i class="fas fa-traffic-light"></i> Traffic Master</div>
        
        <div class="profile-section">
            <div class="profile-header">
                <div class="profile-avatar"><i class="fas fa-user-astronaut"></i></div>
                <div class="profile-info">
                    <h4 id="user-level-name">Rookie</h4>
                    <div class="profile-rank" id="user-level">Level 1</div>
                </div>
            </div>
            <div class="xp-container">
                <div class="xp-bar-bg"><div id="xp-fill" class="xp-bar-fill" style="width: 0%"></div></div>
                <div class="xp-text"><span id="xp-current">0</span> / 100 XP</div>
            </div>
            <div class="achievements-grid">
                <div class="ach-badge" id="ach-1" title="‡∏ô‡∏±‡∏Å‡∏≠‡πà‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà"><i class="fas fa-book-open"></i></div>
                <div class="ach-badge" id="ach-2" title="‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà"><i class="fas fa-car"></i></div>
                <div class="ach-badge" id="ach-3" title="‡πÄ‡∏ó‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏à‡∏£‡∏≤‡∏à‡∏£"><i class="fas fa-crown"></i></div>
            </div>
        </div>

        <button class="nav-btn active" onclick="switchPage('home')"><span>üè†</span> ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
        <div class="menu-label">‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
        <button class="nav-btn" onclick="switchPage('lesson-1')"><span>üìñ</span> 1. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</button>
        <button class="nav-btn" onclick="switchPage('lesson-2')"><span>üõë</span> 2. ‡∏Ñ‡∏•‡∏±‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏£‡∏≤‡∏à‡∏£</button>
        <button class="nav-btn" onclick="switchPage('lesson-3')"><span>üìù</span> 3. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≠‡∏ö</button>
        <button class="nav-btn" onclick="switchPage('game')"><span>üéÆ</span> 4. ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>

        <div class="theme-toggle" onclick="toggleTheme()">
            <span><i class="fas fa-adjust"></i> ‡∏ò‡∏µ‡∏°‡∏°‡∏∑‡∏î/‡∏™‡∏ß‡πà‡∏≤‡∏á</span>
            <i id="theme-icon" class="fas fa-moon"></i>
        </div>
    </aside>

    <main class="main-content">
        <div id="home" class="page-section active">
            <div class="hero-card">
                <div>
                    <div style="font-size: 0.9rem; color: var(--primary); font-weight: 600;">MONTHACHAI DRIVING SCHOOL</div>
                    <div class="typing-text" style="font-size: 1.5rem; font-weight:800; margin:10px 0;">Traffic Learning Hub</div>
                    <p>‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏é‡∏à‡∏£‡∏≤‡∏à‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≠‡∏ö‡πÉ‡∏ö‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡πà</p>
                </div>
                <div style="font-size: 4rem;">üèÅ</div>
            </div>

            <h3 style="margin-bottom: 15px;">‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á Traffic Master?</h3>
            <div class="feature-grid">
                <div class="feature-card"><div class="fc-icon"><i class="fas fa-gamepad"></i></div><h4>‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏ô‡∏∏‡∏Å‡∏°‡∏µ‡πÄ‡∏•‡πÄ‡∏ß‡∏•</h4></div>
                <div class="feature-card"><div class="fc-icon"><i class="fas fa-mobile-alt"></i></div><h4>‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</h4></div>
                <div class="feature-card"><div class="fc-icon"><i class="fas fa-check-circle"></i></div><h4>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏±‡∏ß‡∏£‡πå</h4></div>
            </div>

            <div class="tip-system">
                <div style="font-weight: 800; margin-bottom:10px;"><i class="fas fa-lightbulb"></i> ‡πÄ‡∏Å‡∏£‡πá‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</div>
                <div id="tip-content" style="font-size: 1.1rem; margin-bottom:15px;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                <button class="refresh-btn" onclick="manualRefreshTip()"><i class="fas fa-sync-alt"></i> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</button>
            </div>
            
            <div class="creator-box" style="margin-top:30px;">
                <p>DEVELOPED BY</p>
                <h2>‡∏°‡∏ô‡∏†‡∏ß‡∏±‡∏ï ‡∏ò‡∏±‡∏ç‡∏ç‡∏õ‡∏£‡∏∞‡∏î‡∏¥‡∏©‡∏ê‡πå</h2>
            </div>
        </div>

        <div id="lesson-1" class="page-section">
            <h1>üìñ 1. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h1>
            <div class="lesson-card">
                <h2>üìú ‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏ó‡∏≤‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢</h2>
                <div style="background: var(--secondary); padding: 15px; border-left: 4px solid var(--primary); border-radius: 5px;">
                    "<strong>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏£‡∏≤‡∏à‡∏£</strong> ‡∏Ñ‡∏∑‡∏≠‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏° ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ß‡∏¥‡∏ô‡∏±‡∏¢"
                </div>
            </div>
            <div class="lesson-card">
                 <h2>üé® ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏™‡∏µ</h2>
                 <ul style="padding-left:20px;">
                     <li><strong>‡∏™‡∏µ‡πÅ‡∏î‡∏á:</strong> ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö / ‡∏´‡πâ‡∏≤‡∏°</li>
                     <li><strong>‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á:</strong> ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ß‡∏±‡∏á</li>
                     <li><strong>‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô/‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß:</strong> ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</li>
                 </ul>
            </div>
            <button class="welcome-btn" style="width:100%;" onclick="gainXP(50); this.disabled=true; playSFX('sfx-correct');">‚úÖ ‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏ö‡∏£‡∏±‡∏ö 50 XP</button>
        </div>

        <div id="lesson-2" class="page-section">
            <h1>üõë 2. ‡∏Ñ‡∏•‡∏±‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡∏à‡∏£‡∏≤‡∏à‡∏£</h1>
            <div class="tabs">
                <button class="tab-btn active" onclick="filterSigns('all')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                <button class="tab-btn" onclick="filterSigns('mandatory')">‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö</button>
                <button class="tab-btn" onclick="filterSigns('warning')">‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</button>
                <button class="tab-btn" onclick="filterSigns('info')">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</button>
            </div>
            <div id="sign-container" class="sign-grid"></div>
        </div>

        <div id="lesson-3" class="page-section">
            <h1>üìù 3. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≠‡∏ö</h1>
            <div class="lesson-card">
                <h2>Checklist ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°</h2>
                <div class="checklist-item" onclick="toggleCheck(this)"><div class="cb-box"><i class="fas fa-check"></i></div><div>‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á</div></div>
                <div class="checklist-item" onclick="toggleCheck(this)"><div class="cb-box"><i class="fas fa-check"></i></div><div>‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå</div></div>
            </div>
        </div>

        <div id="game" class="page-section">
            <h1>üéÆ 4. ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h1>
            <div class="game-area">
                <div id="g-start">
                    <div style="font-size: 5rem; margin-bottom: 20px;">üèÜ</div>
                    <h2>‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÑ‡∏´‡∏°?</h2>
                    <p>‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏•‡∏∞ 20 XP</p>
                    <button class="welcome-btn" onclick="startGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö</button>
                </div>
                <div id="g-play" style="display:none;">
                    <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                        <span id="q-counter">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1/5</span> <span id="timer-text">30s</span>
                    </div>
                    <div class="timer-bar"><div id="timer-fill" class="timer-fill"></div></div>
                    <div id="q-icon" style="margin: 20px 0; min-height:100px; display:flex; align-items:center; justify-content:center;"></div>
                    <h3 id="q-question" style="margin-bottom:20px;">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°?</h3>
                    <div id="q-options" class="options-grid"></div>
                </div>
                <div id="g-result" style="display:none;">
                    <h2>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
                    <h1 style="color:var(--primary); font-size:4rem;" id="final-score">0/5</h1>
                    <p id="xp-gained-text" style="color:var(--success); font-weight:bold;">+0 XP</p>
                    <button class="welcome-btn" onclick="startGame()" style="background:transparent; border:2px solid var(--primary); color:var(--primary); box-shadow:none; margin-top:20px;">‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà</button>
                </div>
            </div>
        </div>
    </main>

    <script>
        // --- MOBILE SYSTEM ---
        function toggleSidebar() {
            document.querySelector('.sidebar').classList.toggle('active');
            document.querySelector('.menu-overlay').classList.toggle('active');
        }

        // --- CORE SYSTEM ---
        function playSFX(id) { document.getElementById(id).currentTime=0; document.getElementById(id).play().catch(()=>{}); }
        function enterSite() { 
            document.getElementById('welcome-sound').play().catch(()=>{});
            document.getElementById('welcome-overlay').style.opacity='0';
            setTimeout(()=>{document.getElementById('welcome-overlay').style.display='none';},500);
            unlockAchievement('1','‡∏ô‡∏±‡∏Å‡∏≠‡πà‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà'); randomTip();
        }
        function switchPage(pageId) {
            playSFX('sfx-click');
            document.querySelectorAll('.page-section').forEach(el=>el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el=>el.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            // Auto close menu on mobile
            document.querySelector('.sidebar').classList.remove('active');
            document.querySelector('.menu-overlay').classList.remove('active');
            window.scrollTo(0,0);
        }

        // --- THEME & XP ---
        let isDarkMode = localStorage.getItem('darkMode')==='true';
        if(isDarkMode) { document.body.classList.add('dark-mode'); document.getElementById('theme-icon').className='fas fa-sun'; }
        function toggleTheme() {
            isDarkMode=!isDarkMode; document.body.classList.toggle('dark-mode',isDarkMode);
            document.getElementById('theme-icon').className = isDarkMode ? 'fas fa-sun' : 'fas fa-moon';
            localStorage.setItem('darkMode',isDarkMode); playSFX('sfx-click');
        }

        let userXP = parseInt(localStorage.getItem('userXP'))||0;
        let achievements = JSON.parse(localStorage.getItem('achievements'))||[];
        function updateProfileUI() {
            let lvl = Math.floor(userXP/100)+1;
            document.getElementById('user-level').innerText = `Level ${lvl}`;
            document.getElementById('xp-current').innerText = userXP%100;
            document.getElementById('xp-fill').style.width = `${userXP%100}%`;
            localStorage.setItem('userXP',userXP);
            if(achievements.includes('1')) document.getElementById('ach-1').classList.add('unlocked');
            if(achievements.includes('2')) document.getElementById('ach-2').classList.add('unlocked');
            if(achievements.includes('3')) document.getElementById('ach-3').classList.add('unlocked');
        }
        function gainXP(amt) { userXP+=amt; updateProfileUI(); }
        function unlockAchievement(id,txt) {
            if(!achievements.includes(id)) {
                achievements.push(id); localStorage.setItem('achievements',JSON.stringify(achievements));
                updateProfileUI(); showToast(`üèÜ ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ: ${txt}`); confetti({particleCount:100,spread:70,origin:{y:0.6}});
            }
        }
        function showToast(txt) {
            const t=document.getElementById("toast"); document.getElementById("toast-msg").innerText=txt;
            t.className="show"; setTimeout(()=>{t.className=t.className.replace("show","");},3000);
        }
        function toggleCheck(el){ el.classList.toggle('checked'); playSFX('sfx-click'); }

        // --- DATA ---
        const trafficData = [
            { type: 'mandatory', icon: '<img src="‡∏´‡∏¢‡∏∏‡∏î‡∏î.png">', name: '‡∏õ‡πâ‡∏≤‡∏¢‡∏´‡∏¢‡∏∏‡∏î', desc: '‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏ñ‡πÉ‡∏´‡πâ‡∏™‡∏ô‡∏¥‡∏ó' },
            { type: 'mandatory', icon: 'üîª', name: '‡πÉ‡∏´‡πâ‡∏ó‡∏≤‡∏á', desc: '‡πÉ‡∏´‡πâ‡∏£‡∏ñ‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤‡∏á‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô' },
            { type: 'mandatory', icon: '‚õî', name: '‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤', desc: '‡∏´‡πâ‡∏≤‡∏°‡∏ú‡πà‡∏≤‡∏ô' },
            { type: 'warning', icon: '‚Ü™Ô∏è', name: '‡πÇ‡∏Ñ‡πâ‡∏á‡∏ã‡πâ‡∏≤‡∏¢', desc: '‡∏£‡∏∞‡∏ß‡∏±‡∏á‡πÇ‡∏Ñ‡πâ‡∏á‡∏ã‡πâ‡∏≤‡∏¢' },
            { type: 'info', icon: 'üÖøÔ∏è', name: '‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏î‡∏£‡∏ñ', desc: '‡∏à‡∏≠‡∏î‡πÑ‡∏î‡πâ' }
        ];
        function renderSigns(filter) {
            const c=document.getElementById('sign-container'); c.innerHTML='';
            const d=filter==='all'?trafficData:trafficData.filter(i=>i.type===filter);
            d.forEach(i=>{
                let cls=i.type==='mandatory'?'bg-red':(i.type==='warning'?'bg-yellow':'bg-blue');
                c.innerHTML+=`<div class="sign-card"><div class="sign-icon">${i.icon}</div><div><span class="badge ${cls}">${i.type}</span><div style="font-weight:bold;font-size:0.9rem;">${i.name}</div></div></div>`;
            });
        }
        function filterSigns(t) { renderSigns(t); document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active')); event.target.classList.add('active'); }

        // --- QUIZ ---
        const myQuiz = [
            { q:"‡∏õ‡πâ‡∏≤‡∏¢‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?", img:'<img src="‡∏´‡∏¢‡∏∏‡∏î‡∏î.png" style="width:100px;">', o:["‡∏ä‡∏∞‡∏•‡∏≠","‡∏´‡∏¢‡∏∏‡∏î‡∏™‡∏ô‡∏¥‡∏ó","‡∏ö‡∏µ‡∏ö‡πÅ‡∏ï‡∏£","‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏ß"], a:"‡∏´‡∏¢‡∏∏‡∏î‡∏™‡∏ô‡∏¥‡∏ó" },
            { q:"‡πÑ‡∏ü‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á?", img:'<div style="font-size:4rem;">üü°</div>', o:["‡πÄ‡∏£‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß","‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏´‡∏¢‡∏∏‡∏î","‡∏à‡∏≠‡∏î‡∏£‡∏ñ","‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏ß‡πÑ‡∏î‡πâ"], a:"‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏´‡∏¢‡∏∏‡∏î" }
        ];
        let score=0, qIndex=0, timer, timeLeft=30;
        function startGame() {
            playSFX('sfx-click'); score=0; qIndex=0;
            document.getElementById('g-start').style.display='none'; document.getElementById('g-result').style.display='none';
            document.getElementById('g-play').style.display='block';
            nextQuestion();
        }
        function nextQuestion() {
            if(qIndex>=myQuiz.length) { endGame(); return; } // ‡πÅ‡∏Å‡πâ‡πÉ‡∏´‡πâ‡∏à‡∏ö‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏µ
            timeLeft=30; clearInterval(timer);
            timer=setInterval(()=>{
                timeLeft--; document.getElementById('timer-text').innerText=timeLeft+'s';
                document.getElementById('timer-fill').style.width=(timeLeft/30*100)+'%';
                if(timeLeft<=0) endGame();
            },1000);
            
            let item = myQuiz[qIndex];
            document.getElementById('q-counter').innerText=`‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${qIndex+1}`;
            document.getElementById('q-question').innerText=item.q;
            document.getElementById('q-icon').innerHTML=item.img||'';
            const c=document.getElementById('q-options'); c.innerHTML='';
            let opts=[...item.o].sort(()=>0.5-Math.random());
            opts.forEach(opt=>{
                let b=document.createElement('button'); b.className='opt-btn'; b.innerText=opt;
                b.onclick=()=>{ 
                    if(opt===item.a){ score++; playSFX('sfx-correct'); } else playSFX('sfx-wrong');
                    qIndex++; nextQuestion();
                };
                c.appendChild(b);
            });
        }
        function endGame() {
            clearInterval(timer);
            document.getElementById('g-play').style.display='none'; document.getElementById('g-result').style.display='block';
            document.getElementById('final-score').innerText=score+"/"+myQuiz.length;
            gainXP(score*20); unlockAchievement('2','‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà');
        }

        // --- TIPS ---
        const tips=["‡πÄ‡∏°‡∏≤‡πÑ‡∏°‡πà‡∏Ç‡∏±‡∏ö ‡∏õ‡∏£‡∏±‡∏ö‡∏´‡∏ô‡∏±‡∏Å!","‡∏Ñ‡∏≤‡∏î‡πÄ‡∏Ç‡πá‡∏°‡∏Ç‡∏±‡∏î‡∏ô‡∏¥‡∏£‡∏†‡∏±‡∏¢‡πÄ‡∏™‡∏°‡∏≠","‡∏´‡πâ‡∏≤‡∏°‡πÇ‡∏ó‡∏£‡∏Ç‡∏ì‡∏∞‡∏Ç‡∏±‡∏ö"];
        function randomTip() { document.getElementById('tip-content').innerText=tips[Math.floor(Math.random()*tips.length)]; }
        function manualRefreshTip() { playSFX('sfx-click'); randomTip(); }

        // INIT
        renderSigns('all'); updateProfileUI();
    </script>
</body>
</html>